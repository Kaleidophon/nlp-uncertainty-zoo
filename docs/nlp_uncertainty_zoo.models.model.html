<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Models &#8212; nlp-uncertainty-zoo 0.9.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/bootstrap-sphinx.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="SNGP Transformer" href="nlp_uncertainty_zoo.models.sngp_transformer.html" />
    <link rel="prev" title="LSTM Ensemble" href="nlp_uncertainty_zoo.models.lstm_ensemble.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="_static/js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="_static/js/jquery-fix.js"></script>
<script type="text/javascript" src="_static/bootstrap-3.4.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html">
          nlp-uncertainty-zoo</a>
        <span class="navbar-text navbar-version pull-left"><b>0.9.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="nlp_uncertainty_zoo.html">nlp_uncertainty_zoo</a></li>
<li class="toctree-l1"><a class="reference internal" href="nlp_uncertainty_zoo.models.html">Model package</a></li>
<li class="toctree-l1"><a class="reference internal" href="nlp_uncertainty_zoo.models.bayesian_lstm.html">Bayesian LSTM</a></li>
<li class="toctree-l1"><a class="reference internal" href="nlp_uncertainty_zoo.models.bayesian_lstm.html#bayesian-lstm-module-documentation">Bayesian LSTM Module Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="nlp_uncertainty_zoo.models.bert.html">BERT</a></li>
<li class="toctree-l1"><a class="reference internal" href="nlp_uncertainty_zoo.models.bert.html#module-nlp_uncertainty_zoo.models.bert">BERT Module Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="nlp_uncertainty_zoo.models.ddu_transformer.html">DDU Transformer</a></li>
<li class="toctree-l1"><a class="reference internal" href="nlp_uncertainty_zoo.models.ddu_transformer.html#module-nlp_uncertainty_zoo.models.ddu_transformer">DDU Transformer Module Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="nlp_uncertainty_zoo.models.dpp_transformer.html">DPP Transformer</a></li>
<li class="toctree-l1"><a class="reference internal" href="nlp_uncertainty_zoo.models.dpp_transformer.html#module-nlp_uncertainty_zoo.models.dpp_transformer">DPP Transformer Module Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="nlp_uncertainty_zoo.models.lstm.html">LSTM</a></li>
<li class="toctree-l1"><a class="reference internal" href="nlp_uncertainty_zoo.models.lstm.html#module-nlp_uncertainty_zoo.models.lstm">LSTM Module Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="nlp_uncertainty_zoo.models.lstm_ensemble.html">LSTM Ensemble</a></li>
<li class="toctree-l1"><a class="reference internal" href="nlp_uncertainty_zoo.models.lstm_ensemble.html#module-nlp_uncertainty_zoo.models.lstm_ensemble">LSTM Ensemble Module Documentation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="#the-module-class">The <cite>Module</cite> class</a></li>
<li class="toctree-l1"><a class="reference internal" href="#the-model-class">The <cite>Model</cite> class</a></li>
<li class="toctree-l1"><a class="reference internal" href="#module-nlp_uncertainty_zoo.models">Models Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="nlp_uncertainty_zoo.models.sngp_transformer.html">SNGP Transformer</a></li>
<li class="toctree-l1"><a class="reference internal" href="nlp_uncertainty_zoo.models.sngp_transformer.html#module-nlp_uncertainty_zoo.models.sngp_transformer">SNGP Transformer Module Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="nlp_uncertainty_zoo.models.spectral.html">Spectral</a></li>
<li class="toctree-l1"><a class="reference internal" href="nlp_uncertainty_zoo.models.spectral.html#module-nlp_uncertainty_zoo.models.spectral">Spectral Module Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="nlp_uncertainty_zoo.models.st_tau_lstm.html">ST-tau LSTM</a></li>
<li class="toctree-l1"><a class="reference internal" href="nlp_uncertainty_zoo.models.st_tau_lstm.html#module-nlp_uncertainty_zoo.models.st_tau_lstm">ST-tau LSTM Module Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="nlp_uncertainty_zoo.models.transformer.html">Transformer</a></li>
<li class="toctree-l1"><a class="reference internal" href="nlp_uncertainty_zoo.models.transformer.html#module-nlp_uncertainty_zoo.models.transformer">Transformer Module Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="nlp_uncertainty_zoo.models.st_tau_lstm.html">ST-tau LSTM</a></li>
<li class="toctree-l1"><a class="reference internal" href="nlp_uncertainty_zoo.models.st_tau_lstm.html#module-nlp_uncertainty_zoo.models.st_tau_lstm">ST-tau LSTM Module Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="nlp_uncertainty_zoo.models.transformer.html">Transformer</a></li>
<li class="toctree-l1"><a class="reference internal" href="nlp_uncertainty_zoo.models.transformer.html#module-nlp_uncertainty_zoo.models.transformer">Transformer Module Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="nlp_uncertainty_zoo.models.variational_lstm.html">Variational LSTM</a></li>
<li class="toctree-l1"><a class="reference internal" href="nlp_uncertainty_zoo.models.variational_lstm.html#module-nlp_uncertainty_zoo.models.variational_lstm">Variational LSTM Module Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="nlp_uncertainty_zoo.models.variational_transformer.html">Variational Transformer</a></li>
<li class="toctree-l1"><a class="reference internal" href="nlp_uncertainty_zoo.models.variational_transformer.html#variational-transformer-module-documentation">Variational Transformer Module Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="nlp_uncertainty_zoo.utils.html">Utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="nlp_uncertainty_zoo.utils.custom_types.html">Custom Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="nlp_uncertainty_zoo.utils.custom_types.html#module-nlp_uncertainty_zoo.utils.custom_types">Custom Types Module Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="nlp_uncertainty_zoo.utils.data.html">Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="nlp_uncertainty_zoo.utils.data.html#module-nlp_uncertainty_zoo.utils.data">Data Module Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="nlp_uncertainty_zoo.utils.metrics.html">Uncertainty metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="nlp_uncertainty_zoo.utils.metrics.html#module-nlp_uncertainty_zoo.utils.metrics">Metric Module Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="nlp_uncertainty_zoo.utils.samplers.html">Samplers</a></li>
<li class="toctree-l1"><a class="reference internal" href="nlp_uncertainty_zoo.utils.samplers.html#module-nlp_uncertainty_zoo.utils.samplers">Samplers Module Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="nlp_uncertainty_zoo.utils.task_eval.html">Task Eval</a></li>
<li class="toctree-l1"><a class="reference internal" href="nlp_uncertainty_zoo.utils.task_eval.html#module-nlp_uncertainty_zoo.utils.task_eval">Task Eval Module Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="nlp_uncertainty_zoo.utils.uncertainty_eval.html">Uncertainty Eval</a></li>
<li class="toctree-l1"><a class="reference internal" href="nlp_uncertainty_zoo.utils.uncertainty_eval.html#module-nlp_uncertainty_zoo.utils.uncertainty_eval">Uncertainty Eval Module Documentation</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Models</a></li>
<li><a class="reference internal" href="#the-module-class">The <cite>Module</cite> class</a></li>
<li><a class="reference internal" href="#the-model-class">The <cite>Model</cite> class</a></li>
<li><a class="reference internal" href="#module-nlp_uncertainty_zoo.models">Models Documentation</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="nlp_uncertainty_zoo.models.lstm_ensemble.html" title="Previous Chapter: LSTM Ensemble"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; LSTM Ensemble</span>
    </a>
  </li>
  <li>
    <a href="nlp_uncertainty_zoo.models.sngp_transformer.html" title="Next Chapter: SNGP Transformer"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">SNGP Transformer &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="_sources/nlp_uncertainty_zoo.models.model.rst.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <section id="models">
<h1>Models<a class="headerlink" href="#models" title="Permalink to this heading">¶</a></h1>
<p>This module includes abstractions for the model implementation in this package, defining the basic signature
of the <cite>__init__()</cite> method and some mandatory methods that have to be implemented by subclasses.</p>
<p>The idea is to provide all implemented models in two versions to accommodate different users:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">nlp_uncertainty_zoo.models.model.Module</span></code> only defines the basic model logic, but no training loop etc. This is ideal for research projects where you would like to integrate the model into your own repository structure or tinkering.</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">nlp_uncertainty_zoo.models.model.Model</span></code> defines and out-of-the-box solution for direct application. The model can simply be trained calling <code class="xref py py-meth docutils literal notranslate"><span class="pre">nlp_uncertainty_zoo.models.model.Model.fit()</span></code> with some training dataloader.</p></li>
</ul>
</div></blockquote>
</section>
<section id="the-module-class">
<h1>The <cite>Module</cite> class<a class="headerlink" href="#the-module-class" title="Permalink to this heading">¶</a></h1>
<p>The <code class="xref py py-class docutils literal notranslate"><span class="pre">nlp_uncertainty_zoo.models.model.Module</span></code> class is supposed to mirror PyTorch’s <a href="#id1"><span class="problematic" id="id2">`nn.Module&lt;https://pytorch.org/docs/stable/generated/torch.nn.Module.html&gt;`_</span></a> class, only including the bare-bones logic of the
model. By default, input parameters include the number of layers, as well as the sizes for the model vocabulary, embeddings
(<cite>input_size</cite>), hidden activations and number of classes (<cite>output_size</cite>).</p>
<p>One also needs to specify the PyTorch <cite>device</cite> (like “cpu” or “cuda”) and whether the model is used for sequence classification
(<cite>is_sequence_classifier=True</cite>) or sequence labelling (<cite>is_sequence_classifier=False</cite>). Other kind of tasks like regression,
parsing or generation are not supported at the moment.</p>
<p>The following methods have to be implemented by every subclass of <cite>Module</cite>:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">nlp_uncertainty_zoo.models.model.Module.get_logits()</span></code>: Return the logits for a given input, which come in the form of a <cite>torch.FloatTensor</cite> with dimensions <cite>batch_size x sequence_length x output_size</cite> for models with only a single prediction or <cite>batch_size x num_predictions x sequence_length x output_size</cite> for models with multiple predictions, such as MC Dropout or ensembles. If the model is a sequence classifier, <cite>sequence_length</cite> will be 1.</p></li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">nlp_uncertainty_zoo.models.model.Module.predict()</span></code>: Same as <code class="xref py py-meth docutils literal notranslate"><span class="pre">nlp_uncertainty_zoo.models.model.Module.get_logits()</span></code>, except that values on the last axis are actual probabilities summing up to 1.</p></li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">nlp_uncertainty_zoo.models.model.Module.get_sequence_representation()</span></code>: Returns the representation of a sequence of a certain model as a <cite>torch.FloatTensor</cite> of size <cite>batch_size x hidden_size</cite>. For <a class="reference internal" href="nlp_uncertainty_zoo.models.bert.html#module-nlp_uncertainty_zoo.models.bert" title="nlp_uncertainty_zoo.models.bert"><code class="xref py py-mod docutils literal notranslate"><span class="pre">nlp_uncertainty_zoo.models.bert</span></code></a> and <a class="reference internal" href="nlp_uncertainty_zoo.models.transformer.html#module-nlp_uncertainty_zoo.models.transformer" title="nlp_uncertainty_zoo.models.transformer"><code class="xref py py-mod docutils literal notranslate"><span class="pre">nlp_uncertainty_zoo.models.transformer</span></code></a> models, the sequence representation is obtained by using the top-layer hidden activations of the first time step (often corresponding to the <cite>[CLS]</cite> token) after an additional pooler layer, or the last step hidden activations of the last layer of the unidirectional <a class="reference internal" href="nlp_uncertainty_zoo.models.lstm.html#module-nlp_uncertainty_zoo.models.lstm" title="nlp_uncertainty_zoo.models.lstm"><code class="xref py py-mod docutils literal notranslate"><span class="pre">nlp_uncertainty_zoo.models.lstm</span></code></a> classes.</p></li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">nlp_uncertainty_zoo.models.model.Module.get_uncertainty()</span></code>: Return the uncertainty estimates for an input batch, with the return tensor possessing the same shape as with <code class="xref py py-meth docutils literal notranslate"><span class="pre">nlp_uncertainty_zoo.models.model.Module.get_logits()</span></code> or <code class="xref py py-meth docutils literal notranslate"><span class="pre">nlp_uncertainty_zoo.models.model.Module.predict.</span> <span class="pre">If</span> <span class="pre">no</span> <span class="pre">value</span> <span class="pre">is</span> <span class="pre">specified</span> <span class="pre">for</span> <span class="pre">`metric_name()</span></code>, the metric stored in the attribute <cite>default_uncertainty_metric</cite> is used (which usually refers to predictive entropy. If another metric should be used, one of the names in the keys of the attributes <cite>single_prediction_uncertainty_metrics</cite> or <cite>multi_prediction_uncertainty_metrics</cite>.</p></li>
</ul>
</div></blockquote>
</section>
<section id="the-model-class">
<h1>The <cite>Model</cite> class<a class="headerlink" href="#the-model-class" title="Permalink to this heading">¶</a></h1>
<p>The <code class="xref py py-class docutils literal notranslate"><span class="pre">nlp_uncertainty_zoo.models.model.Model</span></code> class is aimed as a complete drop-in solution for anyone who does not want to write training logic and similar aspects.
As input parameters, <code class="xref py py-class docutils literal notranslate"><span class="pre">nlp_uncertainty_zoo.models.model.Model</span></code> expected the name of the model as a string, a reference to a class, the model parameters
as a dictionary of keyword arguments that is passed to the <code class="xref py py-meth docutils literal notranslate"><span class="pre">nlp_uncertainty_zoo.models.model.Module.__init__()</span></code> function of the given <code class="xref py py-class docutils literal notranslate"><span class="pre">nlp_uncertainty_zoo.models.model.Module</span></code> subclass.
The <cite>model_dir</cite> is an optional argument that specified the path to which the model is saved during training.</p>
<p>The user mainly interacts with the <code class="xref py py-class docutils literal notranslate"><span class="pre">nlp_uncertainty_zoo.models.model.Model</span></code> class using the <code class="xref py py-meth docutils literal notranslate"><span class="pre">nlp_uncertainty_zoo.models.model.Model.fit()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">nlp_uncertainty_zoo.models.model.Model.predict()</span></code> and <code class="xref py py-meth docutils literal notranslate"><span class="pre">nlp_uncertainty_zoo.models.model.Model.get_uncertainty()</span></code> functions,
where the latter two mirror the function implementations in <cite>Module</cite>. <code class="xref py py-meth docutils literal notranslate"><span class="pre">nlp_uncertainty_zoo.models.model.Model.fit()</span></code> expects a training and validation set
<a href="#id3"><span class="problematic" id="id4">`torch.utils.data.DataLoader&lt;https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader&gt;`_</span></a> instances.</p>
</section>
<section id="module-nlp_uncertainty_zoo.models">
<span id="models-documentation"></span><h1>Models Documentation<a class="headerlink" href="#module-nlp_uncertainty_zoo.models" title="Permalink to this heading">¶</a></h1>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2022, Dennis Ulmer.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.3.0.<br/>
    </p>
  </div>
</footer>
  </body>
</html>